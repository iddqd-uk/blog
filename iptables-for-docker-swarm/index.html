<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Однажды я решил поднять свой крохотный кластер для приложений, запускаемых в docker-контейнерах. Выбор был между nomad (уже не один комрад его настоятельно рекомендовал - обязательно попробую, но позже), K8S (слишком сложно и дорого по ресурсам для pet-проекта) и Docker Swarm (никакого дополнительного софта не потребуется, поставляется вместе с самим докером). Как ты понимаешь - выбор пал именно на последний.
По тому как его поднять и базово настроить - материалов полно, но когда дело дошло до настройки огненной стены - вот тут начались некоторые трудности."><title>Настройка iptables для swarm кластера</title><link rel=canonical href=https://blog.hook.sh/iptables-for-docker-swarm/><link rel=stylesheet href=https://blog.hook.sh/scss/style.min.c81ad01c194dc8cda208713c6fcb1aa14f50b41ffb0f7a7aa16860ae4d9babdc.css><meta property="og:title" content="Настройка iptables для swarm кластера"><meta property="og:description" content="Однажды я решил поднять свой крохотный кластер для приложений, запускаемых в docker-контейнерах. Выбор был между nomad (уже не один комрад его настоятельно рекомендовал - обязательно попробую, но позже), K8S (слишком сложно и дорого по ресурсам для pet-проекта) и Docker Swarm (никакого дополнительного софта не потребуется, поставляется вместе с самим докером). Как ты понимаешь - выбор пал именно на последний.
По тому как его поднять и базово настроить - материалов полно, но когда дело дошло до настройки огненной стены - вот тут начались некоторые трудности."><meta property="og:url" content="https://blog.hook.sh/iptables-for-docker-swarm/"><meta property="og:site_name" content="blog [dot] hook"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="linux"><meta property="article:tag" content="iptables"><meta property="article:tag" content="swarm"><meta property="article:tag" content="docker"><meta property="article:tag" content="security"><meta property="article:published_time" content="2020-07-06T15:11:47+00:00"><meta property="article:modified_time" content="2020-07-06T15:11:47+00:00"><meta property="og:image" content="https://blog.hook.sh/iptables-for-docker-swarm/cover.jpg"><meta name=twitter:title content="Настройка iptables для swarm кластера"><meta name=twitter:description content="Однажды я решил поднять свой крохотный кластер для приложений, запускаемых в docker-контейнерах. Выбор был между nomad (уже не один комрад его настоятельно рекомендовал - обязательно попробую, но позже), K8S (слишком сложно и дорого по ресурсам для pet-проекта) и Docker Swarm (никакого дополнительного софта не потребуется, поставляется вместе с самим докером). Как ты понимаешь - выбор пал именно на последний.
По тому как его поднять и базово настроить - материалов полно, но когда дело дошло до настройки огненной стены - вот тут начались некоторые трудности."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.hook.sh/iptables-for-docker-swarm/cover.jpg"><script async src="https://www.googletagmanager.com/gtag/js?id=G-1B4Z5Q844N"></script><script>var dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-1B4Z5Q844N',{anonymize_ip:!0})}</script><link rel=apple-touch-icon sizes=180x180 href="https://blog.hook.sh/apple-touch-icon.png?v=1633428052"><link rel=icon type=image/png sizes=32x32 href="https://blog.hook.sh/favicon-32x32.png?v=1633428052"><link rel=icon type=image/png sizes=16x16 href="https://blog.hook.sh/favicon-16x16.png?v=1633428052"><link rel=manifest href=https://blog.hook.sh/webmanifest.json><meta name=msapplication-TileColor content="#303030"><meta name=theme-color content="#303030"></head><body class="article-page has-toc"><script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"dark")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script><div class="container main-container flex
extended"><div id=article-toolbar><a href=https://blog.hook.sh/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg><span>Назад</span></a></div><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/iptables-for-docker-swarm/><img src=/iptables-for-docker-swarm/cover_huca17b364cb926e2346fafd474740dcec_161710_800x0_resize_q75_box.jpg srcset="/iptables-for-docker-swarm/cover_huca17b364cb926e2346fafd474740dcec_161710_800x0_resize_q75_box.jpg 800w, /iptables-for-docker-swarm/cover_huca17b364cb926e2346fafd474740dcec_161710_1600x0_resize_q75_box.jpg 1600w" width=800 height=400 loading=lazy alt="Featured image of post Настройка iptables для swarm кластера"></a></div><div class=article-details><header class=article-category><a href=/categories/adm/ style=background-color:#a67256;color:#fff>Admin</a>
<a href=/categories/docker/ style=background-color:#0090f4;color:#fff>Docker</a></header><h2 class=article-title><a href=/iptables-for-docker-swarm/>Настройка iptables для swarm кластера</a></h2><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>2020.07.06</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>Время чтения: 6 мин.</time></div></footer></div></header><section class=article-content><div class=outdated-post style=display:none data-posted-at=2020-07-06><strong>Внимание!</strong> Данный пост был опубликован более года назад и, возможно, уже утратил свою былую актуальность. Но это не точно.</div><p>Однажды я решил поднять свой крохотный кластер для приложений, запускаемых в docker-контейнерах. Выбор был между <a class=link href=https://www.nomadproject.io/ target=_blank rel=noopener>nomad</a> <em>(уже не один комрад его настоятельно рекомендовал - обязательно попробую, но позже)</em>, <a class=link href=https://kubernetes.io/ target=_blank rel=noopener>K8S</a> <em>(слишком сложно и дорого по ресурсам для pet-проекта)</em> и <a class=link href=https://docs.docker.com/engine/swarm/ target=_blank rel=noopener>Docker Swarm</a> <em>(никакого дополнительного софта не потребуется, поставляется вместе с самим докером)</em>. Как ты понимаешь - выбор пал именно на последний.</p><p>По тому как его поднять и базово настроить - материалов полно, но когда дело дошло до настройки огненной стены - вот тут начались некоторые трудности. Известно, что <code>docker</code> активно эксплуатирует сетевые интерфейсы и <code>iptables</code> для управления трафиком между сетями и контейнерами. Как настроить ограничения доступа к master и worker-нодам кластерам ниже мы и поговорим.</p><p>Итак, мы имеем:</p><ul><li><code>internal</code>-сеть <code>10.10.10.0/24</code>, к которой подключены все наши серверы - она используется как внутренняя (без ограничений) для общения сервером между собой (при создании swarm был указан сетевой интерфейс, &ldquo;смотрящий&rdquo; в этй сеть <code>docker swarm init --advertise-addr ens11</code>)</li><li>Каждый сервер имеет белый &ldquo;внешний&rdquo; IP адрес (на сетевом интерфейсе <code>eth0</code>)</li><li>Один сервер в роли <code>master</code>-ноды swarm-а - он же выполняет роль точки входа <em>(ingress)</em> в ресурсы кластера, т.е. весь трафик (http(s), tcp, udp) приходит на него и дальше уже перенаправляется в нужные контейнеры балансируя нагрузку (на этом сервере открываются <strong>все необходимые</strong> порты, что должны &ldquo;светиться&rdquo; наружу, естественно, и ssh для административного доступа). Сами контейнеры, что будут обрабатывать трафик находятся на <code>worker</code>-нодах</li><li>Два сервера в роли <code>worker</code>-ов - на них то и запускаются приложения в контейнерах, что обрабатывают наши запросы (tcp/udp пакеты)</li></ul><p>Нам нужно:</p><ul><li>Не ограничивать <strong>исходящий</strong> трафик на серверах на <code>eth0</code> интерфейсе - любой процесс должен без ограничений ходить в глобальную сеть</li><li>Закрыть входящие на всех портах <code>eth0</code>, кроме явно разрешенных (в нашем случае это будет только ssh на <code>worker</code>-нодах и <code>http\https\ssh</code> на <code>master</code>)</li><li>Для <code>internal</code>-сети на интерфейсе <code>ens11</code> не вводить никаких ограничений</li><li>При запуске docker-контейнера, даже с публикацией порта в хост (<code>network: host</code>) - не открывать этот порт &ldquo;наружу&rdquo; (для этого нужно будет явно добавить правило исключения и только на <code>master</code>-ноде)</li></ul><h2 id=worker><code>worker</code></h2><p>Аналогична для всех <code>worker</code>-нод в кластере. Перед выполнением каких-либо манипуляций c <code>iptables</code> настоятельно рекомендую (читай - обязательно) вывести ноду из работы, для чего на <code>master</code> выполни (подставляя имя или ID нужной ноды):</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ docker node ls
ID                            HOSTNAME    STATUS    AVAILABILITY   MANAGER STATUS   ENGINE VERSION
m0au96xa2pfiwxhdhweux5b92 *   ingress-1   Ready     Active         Leader           19.03.12
sweebuhuzfnr2bygrwg4jxddn     node-1      Ready     Active                          19.03.12
5ikrj3ugkdiublkfe70j9upad     node-2      Ready     Active                          19.03.12

$ docker node update node-1 --availability drain
</code></pre></div><p>А по <strong>завершению</strong> работ обратно вводи ноду в строй:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ docker node update node-1 --availability active
</code></pre></div><p>Итак, ставим <code>iptables-persistent</code> (все, что ниже выполняется уже на самой <code>worker</code>-ноде):</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ apt install iptables-persistent
$ <span class=nb>cd</span> /etc/iptables
</code></pre></div><p>И приводим файлы <code>rules.v4</code> и <code>rules.v6</code> к следующему состоянию (правим только <code>filter</code>, оставил только нужные изменения):</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ cat ./rules.v4

<span class=c1># ...</span>
*filter
:INPUT ACCEPT <span class=o>[</span>0:0<span class=o>]</span>
:FORWARD ACCEPT <span class=o>[</span>0:0<span class=o>]</span>
:OUTPUT ACCEPT <span class=o>[</span>0:0<span class=o>]</span>
:CHECKS - <span class=o>[</span>0:0<span class=o>]</span> <span class=c1># added</span>
<span class=c1># ...</span>
-A INPUT -i eth0 -j CHECKS
-A FORWARD ...
-A CHECKS -p tcp -m tcp --dport <span class=m>22</span> -m comment --comment SSH -j ACCEPT
-A CHECKS -m state --state RELATED,ESTABLISHED -j ACCEPT
-A CHECKS -p icmp -m icmp --icmp-type <span class=m>3</span> -j ACCEPT
-A CHECKS -p icmp -m icmp --icmp-type <span class=m>11</span> -j ACCEPT
-A CHECKS -p icmp -m icmp --icmp-type <span class=m>8</span> -m limit --limit 8/sec -j ACCEPT
-A CHECKS -j DROP
-A DOCKER ...
-A DOCKER-ISOLATION-STAGE-1 ...
-A DOCKER-ISOLATION-STAGE-2 ...
-A DOCKER-USER -i eth0 -m state --state RELATED,ESTABLISHED -j ACCEPT
-A DOCKER-USER -i eth0 -j DROP
COMMIT
<span class=c1># ...</span>
</code></pre></div><blockquote><p>Для IPv6 пример взят <a class=link href=https://community.hetzner.com/tutorials/debian-10-docker-install-dual%20stack-ipv6nat-firewall#step-33---create-basic-firewall-rules target=_blank rel=noopener>отсюда</a></p></blockquote><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ cat ./rules.v6

<span class=c1>#...</span>
*filter
:INPUT DROP <span class=o>[</span>0:0<span class=o>]</span>
:FORWARD DROP <span class=o>[</span>0:0<span class=o>]</span>
:OUTPUT DROP <span class=o>[</span>0:0<span class=o>]</span>
:WCFW-ICMP - <span class=o>[</span>0:0<span class=o>]</span>
:WCFW-Local - <span class=o>[</span>0:0<span class=o>]</span>
:WCFW-Services - <span class=o>[</span>0:0<span class=o>]</span>
:WCFW-State - <span class=o>[</span>0:0<span class=o>]</span>
-A INPUT -j WCFW-Local
-A INPUT -j WCFW-State
-A INPUT -p ipv6-icmp -j WCFW-ICMP
-A INPUT -j WCFW-Services
-A OUTPUT -j WCFW-Local
-A OUTPUT -j WCFW-State
-A OUTPUT -j ACCEPT
-A WCFW-ICMP -p ipv6-icmp -m icmp6 --icmpv6-type <span class=m>1</span> -j ACCEPT
-A WCFW-ICMP -p ipv6-icmp -m icmp6 --icmpv6-type <span class=m>2</span> -j ACCEPT
-A WCFW-ICMP -p ipv6-icmp -m icmp6 --icmpv6-type <span class=m>3</span> -j ACCEPT
-A WCFW-ICMP -p ipv6-icmp -m icmp6 --icmpv6-type <span class=m>4</span> -j ACCEPT
-A WCFW-ICMP -p ipv6-icmp -m icmp6 --icmpv6-type <span class=m>133</span> -j ACCEPT
-A WCFW-ICMP -p ipv6-icmp -m icmp6 --icmpv6-type <span class=m>134</span> -j ACCEPT
-A WCFW-ICMP -p ipv6-icmp -m icmp6 --icmpv6-type <span class=m>135</span> -j ACCEPT
-A WCFW-ICMP -p ipv6-icmp -m icmp6 --icmpv6-type <span class=m>136</span> -j ACCEPT
-A WCFW-ICMP -p ipv6-icmp -m icmp6 --icmpv6-type <span class=m>128</span> -m limit --limit 8/sec -j ACCEPT
-A WCFW-Local -i lo -j ACCEPT
-A WCFW-Services -i eth0 -p tcp -m tcp --dport <span class=m>22</span> -m comment --comment SSH -j ACCEPT
-A WCFW-State -m conntrack --ctstate INVALID -j DROP
-A WCFW-State -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
COMMIT
<span class=c1># ...</span>
</code></pre></div><p>После чего заставляем <code>iptables</code> использовать наши правила:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ iptables-restore ./rules.v4
$ ip6tables-restore ./rules.v6
</code></pre></div><h2 id=master><code>master</code></h2><p>Аналогично с <code>worker</code>-ами ставим <code>iptables-persistent</code> и приводим к виду:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ cat ./rules.v4

<span class=c1># ...</span>
*filter
:INPUT ACCEPT <span class=o>[</span>0:0<span class=o>]</span>
:FORWARD ACCEPT <span class=o>[</span>0:0<span class=o>]</span>
:OUTPUT ACCEPT <span class=o>[</span>0:0<span class=o>]</span>
:CHECKS - <span class=o>[</span>0:0<span class=o>]</span> <span class=c1># added</span>
<span class=c1># ...</span>
-A INPUT -i eth0 -j CHECKS
-A FORWARD ...
-A CHECKS -p tcp -m tcp --dport <span class=m>22</span> -m comment --comment SSH -j ACCEPT
-A CHECKS -p tcp -m tcp --dport <span class=m>80</span> -m comment --comment HTTP -j ACCEPT
-A CHECKS -p tcp -m tcp --dport <span class=m>443</span> -m comment --comment HTTPS -j ACCEPT
-A CHECKS -m state --state RELATED,ESTABLISHED -j ACCEPT
-A CHECKS -p icmp -m icmp --icmp-type <span class=m>3</span> -j ACCEPT
-A CHECKS -p icmp -m icmp --icmp-type <span class=m>11</span> -j ACCEPT
-A CHECKS -p icmp -m icmp --icmp-type <span class=m>8</span> -m limit --limit 8/sec -j ACCEPT
-A CHECKS -j DROP
-A DOCKER ...
-A DOCKER-ISOLATION-STAGE-1 ...
-A DOCKER-ISOLATION-STAGE-2 ...
-A DOCKER-USER -i eth0 -p tcp -m tcp -m conntrack --ctorigdstport <span class=m>80</span> -m comment --comment HTTP -j ACCEPT
-A DOCKER-USER -i eth0 -p tcp -m tcp -m conntrack --ctorigdstport <span class=m>443</span> -m comment --comment HTTPS -j ACCEPT
-A DOCKER-USER -i eth0 -m state --state RELATED,ESTABLISHED -j ACCEPT
-A DOCKER-USER -i eth0 -j DROP
COMMIT
<span class=c1># ...</span>
</code></pre></div><p>Для IPv6 настройки оставил аналогичными с <code>worker</code>-нодами. Теперь так выполняем:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ iptables-restore ./rules.v4
$ ip6tables-restore ./rules.v6
</code></pre></div><p>И проверяем <strong>извне</strong> на предмет &ldquo;осталось ли что-нибудь лишнее&rdquo;:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ nmap -v -A -p1-65535 -Pn 11.22.22.11
</code></pre></div><p>Где <code>11.22.22.11</code> наш белый IP сервера (производим такие манипуляции с каждым сервером) - должны остаться открытые только нужные нам порты. Проверяем и корректность работы приложений, запущенных в кластере (те, что ходят в глобальную сеть - должны успешно в неё ходить). Так же проверяем и с самих севреров (как <code>master</code>, так и <code>worker</code>):</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ ping 1.1.1.1
PING 1.1.1.1 <span class=o>(</span>1.1.1.1<span class=o>)</span> 56<span class=o>(</span>84<span class=o>)</span> bytes of data.
<span class=m>64</span> bytes from 1.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>57</span> <span class=nv>time</span><span class=o>=</span>20.2 ms
<span class=m>64</span> bytes from 1.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>57</span> <span class=nv>time</span><span class=o>=</span>20.3 ms

$ ping6 2606:4700:4700::1111
PING 2606:4700:4700::1111<span class=o>(</span>2606:4700:4700::1111<span class=o>)</span> <span class=m>56</span> data bytes
<span class=m>64</span> bytes from 2606:4700:4700::1111: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>56</span> <span class=nv>time</span><span class=o>=</span>21.1 ms
<span class=m>64</span> bytes from 2606:4700:4700::1111: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>56</span> <span class=nv>time</span><span class=o>=</span>21.3 ms

$ docker run --rm alpine:latest ping 1.1.1.1
PING 1.1.1.1 <span class=o>(</span>1.1.1.1<span class=o>)</span>: <span class=m>56</span> data bytes
<span class=m>64</span> bytes from 1.1.1.1: <span class=nv>seq</span><span class=o>=</span><span class=m>0</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>56</span> <span class=nv>time</span><span class=o>=</span>20.531 ms
<span class=m>64</span> bytes from 1.1.1.1: <span class=nv>seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>56</span> <span class=nv>time</span><span class=o>=</span>20.386 ms

$ docker run --rm curlimages/curl -s ipinfo.io/ip
11.22.22.11

$ curl -s ipinfo.io/ip
11.22.22.11
</code></pre></div><h3 id=ссылки-по-теме>Ссылки по теме</h3><ul><li><a class=link href=https://serverfault.com/a/933803 target=_blank rel=noopener>Limiting outside connections to docker container with iptables</a></li><li><a class=link href=https://docs.docker.com/network/iptables/#add-iptables-policies-before-dockers-rules target=_blank rel=noopener>Docker and iptables</a></li><li><a class=link href=https://habr.com/ru/post/333874/ target=_blank rel=noopener>Сети Docker изнутри: как Docker использует iptables и интерфейсы Linux</a></li><li><a class=link href=https://habr.com/ru/post/473222/ target=_blank rel=noopener>Пользовательские правила iptables для docker на примере zabbix</a></li><li><a class=link href=https://community.hetzner.com/tutorials/debian-10-docker-install-dual%20stack-ipv6nat-firewall target=_blank rel=noopener>Install Docker CE on Debian 10 with Dual stack IPv6-NAT and Firewall Support</a></li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/linux/>linux</a>
<a href=/tags/iptables/>iptables</a>
<a href=/tags/swarm/>swarm</a>
<a href=/tags/docker/>docker</a>
<a href=/tags/security/>security</a></section><div style=display:flex;justify-content:space-between;margin-top:1em><div><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>WTFPL</span></section></div><div style=margin-left:auto><section style=height:100%><a href=https://github.com/hook-sh/blog/edit/master/content/post/docker-swarm-iptables/index.md style=font-size:.7em;color:var(--card-text-color-tertiary)>Редиктировать</a></section></div></div></footer></article><aside class=related-contents--wrapper><h2 class=section-title>Может быть интересно</h2><div class=related-contents><div class="flex article-list--tile"><article class=has-image><a href=/ssh-honeypot/><div class=article-image><img src=/ssh-honeypot/cover.a3b24e7c925b55ba3b2c0728bc5d5145_hu3201198c97328eef28a158f0c8170276_222779_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy data-key=ssh-honeypot data-hash="md5-o7JOfJJbVbo7LAcovF1RRQ=="></div><div class=article-details><h2 class=article-title>SSH Honeypot — просто и со вкусом</h2></div></a></article><article class=has-image><a href=/compose-deploy/><div class=article-image><img src=/compose-deploy/cover.31826785bbf29e0ec311943642776de7_hu65abd86000f73060febdb2dd524fa8aa_21589_250x150_fill_box_smart1_2.png width=250 height=150 loading=lazy data-key=compose-deploy data-hash="md5-MYJnhbvyng7DEZQ2Qndt5w=="></div><div class=article-details><h2 class=article-title>Деплой на Docker Swarm</h2></div></a></article><article class=has-image><a href=/laravel-in-docker/><div class=article-image><img src=/laravel-in-docker/cover.b1af8b61b8071829ccda762b84134ba2_hua8f71ffb89a9e5aa8906e7ae93fcb2fc_87557_250x150_fill_box_smart1_2.png width=250 height=150 loading=lazy data-key=laravel-in-docker data-hash="md5-sa+LYbgHGCnM2nYrhBNLog=="></div><div class=article-details><h2 class=article-title>Docker + Laravel = ❤</h2></div></a></article><article class=has-image><a href=/little-iptables-tips/><div class=article-image><img src=/little-iptables-tips/cover.46786305ea94fea9001f78310af2161c_huca17b364cb926e2346fafd474740dcec_161710_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy data-key=little-iptables-tips data-hash="md5-RnhjBeqU/qkAH3gxCvIWHA=="></div><div class=article-details><h2 class=article-title>Маленькая хитрость iptables</h2></div></a></article><article class=has-image><a href=/compile-and-config-msmtp/><div class=article-image><img src=/compile-and-config-msmtp/cover.74e5f5752c378bc5c249233e9c0f8284_hub577c79af8463c924351e5a1445741f0_93501_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy data-key=compile-and-config-msmtp data-hash="md5-dOX1dSw3i8XCSSM+nA+ChA=="></div><div class=article-details><h2 class=article-title>Собираем и настраиваем msmtp</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=hook-sh/blog issue-term=pathname crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>function setUtterancesTheme(b){let a=document.querySelector('.utterances iframe');a&&a.contentWindow.postMessage({type:'set-theme',theme:`github-${b}`},'https://utteranc.es')}addEventListener('message',a=>{if(a.origin!=='https://utteranc.es')return;setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener('onColorSchemeChange',a=>{setUtterancesTheme(a.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2014 -
2021 blog [dot] hook</section><section class=powerby>Make love, not war<br></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Содержание</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#worker><code>worker</code></a></li><li><a href=#master><code>master</code></a><ol><li><a href=#ссылки-по-теме>Ссылки по теме</a></li></ol></li></ol></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script><script data-no-instant>(function(){const a=document.querySelectorAll('.outdated-post'),b=new Date;for(let c=0,f=a.length;c<f;c++){const d=a[c],e=new Date(d.getAttribute('data-posted-at'));if(!isNaN(e.valueOf())&&e.getFullYear()>1){const a=Math.abs(b.getTime()-e.getTime()),c=Math.ceil(a/(1e3*3600*24));c>=547&&(d.style.display='block',d.style.visibility='visible')}}})()</script></body></html>